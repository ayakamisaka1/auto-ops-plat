# AI 中台基础能力域（LLM Foundation Domain）设计说明

> 本文档用于完整描述 AI 中台中 **大模型基础能力域** 的设计目标、领域拆分、实体模型与演进边界。
>
> 该文档可作为：
>
> * 架构设计说明
> * 代码复刻依据
> * DDD 建模文档
> * 后续 Agent / Flow / MCP 扩展的基础

---

## 一、设计背景与目标

### 1.1 背景

传统 AI 系统往往存在以下问题：

* 大模型厂商与代码强耦合（OpenAI / 阿里 / DeepSeek 写死）
* 模型、能力、调用地址混在一起
* Agent / 工具 / 运维直接依赖 SDK
* 无法支持多模型、多能力、多路由策略

### 1.2 中台化目标

AI 中台的目标不是“聊天”，而是：

> **对上提供统一 AI 能力抽象，对下屏蔽模型与厂商差异**

因此需要一套：

* 可扩展
* 可治理
* 可运维
* 可被流程编排

的 **基础能力域模型**。

---

## 二、领域拆分（DDD 视角）

### 2.1 所属领域

当前设计属于：

> **AI 基础能力域（Foundation / Capability Domain）**

该域只关心：

* 有哪些 LLM 资源
* 能提供什么能力
* 如何被调用

不关心：

* Agent 业务逻辑
* 流程编排
* 运维策略

---

## 三、核心实体模型

### 3.1 实体关系总览

```
AiLlmProvider
      │ 1..N
      ▼
AiLlmModel
      │ 1..N
      ▼
AiLlmEndpoint
```

---

## 四、实体详细说明

### 4.1 AiLlmProvider（LLM 服务提供商）

#### 4.1.1 语义定义

表示一个**逻辑上的大模型服务提供者**，例如：

* OpenAI
* DeepSeek
* 阿里云
* 本地私有化部署

#### 4.1.2 设计原则

* 只描述“存在与接入方式”
* 不存 API Key / Secret
* 不包含任何模型或能力细节

#### 4.1.3 典型字段

* providerCode：中台级唯一标识
* providerType：CLOUD / PRIVATE / LOCAL
* baseUrl：默认访问地址
* authType：API_KEY / OAUTH

#### 4.1.4 DDD 定位

* 资源实体（Resource Entity）
* 可作为 Provider 聚合根

---

### 4.2 AiLlmModel（LLM 模型）

#### 4.2.1 语义定义

表示 AI 中台中一个**可被选择、可被路由的模型单元**。

例如：

* gpt-4o
* deepseek-chat
* qwen-max

#### 4.2.2 设计原则

* 模型 ≠ 调用地址
* 模型 ≠ 调用参数
* 模型 ≠ Agent

#### 4.2.3 能力约束字段

* contextLength
* maxOutputTokens
* supportsStream
* supportsFunctionCall
* supportsVision

这些字段用于：

* Agent 选择校验
* 流程运行期保护
* 自动能力路由

#### 4.2.4 DDD 定位

* 领域实体（Entity）
* Model 聚合根

---

### 4.3 AiLlmEndpoint（模型能力接口）

#### 4.3.1 语义定义

描述某个模型在某个 Provider 下，
**对外暴露的能力访问接口**。

例如：

* Chat Completion
* Embedding
* Vision

#### 4.3.2 能力即资源

该实体将“接口”抽象为：

> **可治理、可启停、可编排的能力资源**

#### 4.3.3 典型能力类型

* CHAT_COMPLETION
* EMBEDDING
* VISION
* AUDIO
* FUNCTION_CALL

#### 4.3.4 为什么 Endpoint 独立建表

* 一个模型可以有多个能力
* 不同能力可能有不同地址
* 运维可以单独禁用某个能力

#### 4.3.5 DDD 定位

* 能力描述实体
* 被 Agent / Tool / Flow 使用

---

## 五、为什么这样设计是“中台级”的

### 5.1 与传统设计的区别

| 传统方式   | AI 中台方式    |
| ------ | ---------- |
| SDK 直连 | 能力抽象       |
| URL 写死 | Endpoint 表 |
| 模型即能力  | 模型 + 能力    |
| 运维无感   | 能力可治理      |

---

## 六、与 Agent / Flow / MCP 的关系

### 6.1 Agent

* 不感知 Provider
* 不感知 URL
* 只选择：能力类型 + 模型约束

### 6.2 Flow

* 按节点选择能力
* 动态调度不同 Agent

### 6.3 MCP / 运维

* Endpoint 即监控对象
* 可对单能力做熔断 / 下线

---

## 七、演进路线（后续扩展）

### 7.1 下一阶段核心表

* ai_agent
* ai_agent_capability
* ai_tool
* ai_agent_tool
* ai_flow
* ai_flow_node

### 7.2 智能运维（不强绑定）

* 运维 MCP 作为 Tool 接入
* 通过 Endpoint 状态影响 Agent 行为

---

## 八、总结

本设计实现了：

* LLM 能力的标准化建模
* 多厂商、多模型、多能力解耦
* 为 Agent / Flow / 运维提供统一基础

> **这是一个“可生长的 AI 中台底座”，而不是一次性系统。**

---

（文档完）
